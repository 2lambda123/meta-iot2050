From 19c0d77bb61f992521a731f1bab457945fd0cf86 Mon Sep 17 00:00:00 2001
From: Grygorii Strashko <grygorii.strashko@ti.com>
Date: Fri, 17 Sep 2021 17:00:21 +0300
Subject: [PATCH 102/150] net: ethernet: ti: icssg_prueth: fix llvm build warn

Fix:
drivers/net/ethernet/ti/icssg_prueth.c:2106:6: warning: variable 'ret' is used uninitialized whenever 'if' condition is true [-Wsometimes-uninitialized]
       if (!emac->cmd_wq)
           ^~~~~~~~~~~~~
drivers/net/ethernet/ti/icssg_prueth.c:2222:9: note: uninitialized use occurs here
       return ret;
              ^~~

Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
Signed-off-by: Vignesh Raghavendra <vigneshr@ti.com>
---
 drivers/net/ethernet/ti/icssg_prueth.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/ti/icssg_prueth.c b/drivers/net/ethernet/ti/icssg_prueth.c
index 77494cb717bf..deaec66ab721 100644
--- a/drivers/net/ethernet/ti/icssg_prueth.c
+++ b/drivers/net/ethernet/ti/icssg_prueth.c
@@ -2103,8 +2103,10 @@ static int prueth_netdev_init(struct prueth *prueth,
 	emac->ndev = ndev;
 	emac->port_id = port;
 	emac->cmd_wq = create_singlethread_workqueue("icssg_cmd_wq");
-	if (!emac->cmd_wq)
+	if (!emac->cmd_wq) {
+		ret = -ENOMEM;
 		goto free_ndev;
+	}
 	INIT_WORK(&emac->rx_mode_work, emac_ndo_set_rx_mode_work);
 
 	ret = pruss_request_mem_region(prueth->pruss,
-- 
2.34.1

